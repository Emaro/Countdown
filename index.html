<!DOCTYPE html>
<html lang="en">

<meta charset="UTF-8">
<title>Countdown</title>

<h1>Countdown</h1>

<form action="">
    <input id="hh" value="0" autofocus>
    <input id="mm" value="1">
    <input id="ss" value="0">
    <input type="button" value="Start" onclick="startCountdown()">
</form>

<p id="output"></p>


<button onclick="notifyMe()">Notify me!</button>

<script>

    var targetTime;
    var timer;

    function startCountdown() {

        requestNotificationPermisson();
        notify();
        
        
        timer = null;

        targetTime = new Date().getTime();
        targetTime += parseInt(document.getElementById("hh").value) * 60 * 60 * 1000;
        targetTime += parseInt(document.getElementById("mm").value) * 60 * 1000;
        targetTime += parseInt(document.getElementById("ss").value) * 1000;

        targetTime = new Date(targetTime);

        countToZero();

        timer = setInterval(countToZero, 100);
    }

    function countToZero() {

        var dif = targetTime - new Date(); // ms

        var saveDif = dif;

        dif /= 1000; // s
        var sec = Math.floor(dif % 60);
        dif /= 60; // m
        var min = Math.floor(dif % 60);
        dif /= 60 // h;
        var hour = Math.floor(dif);

        document.getElementById("output").innerHTML = pad(hour) + ":" + pad(min) + ":" + pad(sec);

        if (saveDif <= 100) {
            dif = 0;
            document.getElementById("output").innerHTML = pad(dif) + ":" + pad(dif) + ":" + pad(dif);
            alert("Countdown finished");
            clearInterval(timer);
        }
    }

    function pad(n) {
        return (n < 10) ? ("0" + n) : n;
    }

    function requestNotificationPermisson() {
        if ("Notification" in Window && Notification.permission === "default") {
            console.log("Not in win");
            Notification.requestPermission(function (permission) {
                // If the user accepts, let's create a notification
                if (permission === "granted") {
                    var notification = new Notification("Hi there!");
                }
            });
        }
        else if (Notification.permission === "granted") {
            console.log("Granted");
            var notification = new Notification("Hi there!");
        }
    }
    
    function notify() {
        console.log("Notify");
        var notification = new Notification("Hi there!");
    }


    // request permission on page load
    document.addEventListener('DOMContentLoaded', function () {
        if (!Notification) {
            alert('Desktop notifications not available in your browser. Try Chromium.');
            return;
        }

        if (Notification.permission !== "granted")
            Notification.requestPermission();
    });

    function notifyMe() {
        if (Notification.permission !== "granted")
            Notification.requestPermission();
        else {
            var notification = new Notification('Notification title', {
                icon: 'http://cdn.sstatic.net/stackexchange/img/logos/so/so-icon.png',
                body: "Hey there! You've been notified!",
            });

            notification.onclick = function () {
                window.open("http://stackoverflow.com/a/13328397/1269037");
            };

        }

    }
</script>
</html>